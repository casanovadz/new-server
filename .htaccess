<IfModule mod_rewrite.c>
    RewriteEngine On
    
    # إعادة التوجيه إلى HTTPS
    RewriteCond %{HTTPS} off
    RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]
    
    # حماية ضد هجمات الـ XSS
    Header set X-XSS-Protection "1; mode=block"
    Header always append X-Frame-Options SAMEORIGIN
    Header set X-Content-Type-Options nosniff
    
    # سياسة أمان المحتوى
    Header set Content-Security-Policy "default-src 'self'; script-src 'self' 'unsafe-inline'"
    
    # تعطيل تخزين التتبع
    Header set Referrer-Policy "strict-origin-when-cross-origin"
</IfModule>

# تعطيل سرد الملفات
Options -Indexes

# حماية ملفات حساسة
<FilesMatch "\.(env|log|sql)$">
    Require all denied
</FilesMatch>